# NPM vs Traefik: Что выбрать?

## 🎯 Краткий ответ

**Новичкам** → Nginx Proxy Manager (GUI, просто)
**Опытным** → Traefik (Infrastructure as Code, автоматизация)

---

## 📊 Детальное сравнение

| Критерий | Nginx Proxy Manager | Traefik |
|----------|-------------------|---------|
| **Настройка** | 🟢 GUI веб-интерфейс | 🟡 Docker labels / YAML |
| **Кривая обучения** | 🟢 Легко (как админка) | 🟡 Средне (нужно знать Docker) |
| **Автоматизация** | 🔴 Ручная настройка | 🟢 Автообнаружение |
| **Infrastructure as Code** | 🔴 Нет (GUI) | 🟢 Да (всё в коде) |
| **SSL сертификаты** | 🟢 Автоматически (GUI) | 🟢 Автоматически (labels) |
| **Dashboard** | 🟢 Есть | 🟢 Есть |
| **Производительность** | 🟢 Отлично | 🟢 Отлично |
| **Гибкость** | 🟡 Средняя | 🟢 Высокая |
| **Мониторинг** | 🟡 Базовый | 🟢 Prometheus metrics |
| **Обновления** | 🟢 Через GUI | 🟡 Через редеплой |

---

## 🎭 Примеры использования

### Nginx Proxy Manager

**Добавление нового сайта:**

1. Открываете GUI (http://IP:81)
2. Add Proxy Host
3. Заполняете форму:
   - Domain: blog.prvms.ru
   - Forward to: blog_wordpress:80
   - SSL: ✅
4. Save

**Готово! 30 секунд.**

---

### Traefik

**Добавление нового сайта:**

1. Добавляете labels в docker-compose:
```yaml
services:
  wordpress:
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.blog.rule=Host(`blog.prvms.ru`)"
      - "traefik.http.routers.blog.tls.certresolver=letsencrypt"
```

2. Запускаете:
```bash
docker-compose up -d
```

**Готово! 1 минута. Всё в коде!**

---

## 🏗️ Архитектура

### NPM

```
┌─────────────────────┐
│  NPM Web GUI :81    │ ← Вы настраиваете здесь
└──────────┬──────────┘
           │
┌──────────▼──────────┐
│   NPM Proxy :80/443 │
└──────────┬──────────┘
           │
      ┌────┴────┬─────────┬──────────┐
      │         │         │          │
   App 1     App 2     App 3      App N
```

### Traefik

```
┌─────────────────────────────────────┐
│  docker-compose.yml (labels)        │ ← Вы настраиваете здесь
└─────────────────────────────────────┘
           │ (автоматически)
┌──────────▼──────────┐
│  Traefik :80/443    │
└──────────┬──────────┘
           │
      ┌────┴────┬─────────┬──────────┐
      │         │         │          │
   App 1     App 2     App 3      App N
```

---

## 💡 Когда использовать NPM

### ✅ Используйте NPM если:

1. **Вы новичок** в Docker/DevOps
2. **Нужен GUI** - любите визуальные интерфейсы
3. **Нечастые изменения** - добавляете сайты редко
4. **Небольшой проект** - 2-5 сайтов
5. **Не нужна автоматизация** - ручная настройка OK

### Примеры:
- Личный блог + портфолио
- Несколько WordPress сайтов
- Простой хостинг для друзей

---

## 🚀 Когда использовать Traefik

### ✅ Используйте Traefik если:

1. **Infrastructure as Code** - всё в git
2. **Частые изменения** - постоянно добавляете сервисы
3. **Микросервисы** - много контейнеров
4. **CI/CD** - автоматический деплой
5. **Нужен мониторинг** - Prometheus/Grafana
6. **Динамическая конфигурация** - контейнеры появляются/исчезают

### Примеры:
- SaaS приложение с микросервисами
- Dev/Staging/Prod окружения
- Kubernetes кластер
- Проект с частыми деплоями

---

## 📈 Сценарии использования

### Сценарий 1: Простой хостинг

**Задача**: Разместить WordPress блог и Django сайт

**NPM**: ⭐⭐⭐⭐⭐
- Открыл GUI
- Добавил 2 Proxy Hosts
- Готово за 2 минуты

**Traefik**: ⭐⭐⭐
- Написал docker-compose с labels
- Разобрался с синтаксисом
- Готово за 10 минут

**Победитель**: NPM

---

### Сценарий 2: Микросервисная архитектура

**Задача**: 20 микросервисов, частые обновления

**NPM**: ⭐⭐
- Каждый раз открывать GUI
- Вручную добавлять новые сервисы
- Нет версионирования конфига

**Traefik**: ⭐⭐⭐⭐⭐
- Всё в docker-compose.yml
- Автообнаружение новых сервисов
- Конфиг в git
- CI/CD интеграция

**Победитель**: Traefik

---

### Сценарий 3: Dev/Staging/Prod

**Задача**: Одинаковая конфигурация на 3 окружениях

**NPM**: ⭐⭐
- Настраивать вручную 3 раза
- Риск ошибок
- Сложно синхронизировать

**Traefik**: ⭐⭐⭐⭐⭐
- Один docker-compose.yml
- Переменные окружения
- `git clone` → `docker-compose up`

**Победитель**: Traefik

---

### Сценарий 4: Первый проект

**Задача**: Новичок, первый раз настраиваю reverse proxy

**NPM**: ⭐⭐⭐⭐⭐
- Интуитивный GUI
- Визуальная обратная связь
- Легко экспериментировать

**Traefik**: ⭐⭐
- Нужно учить синтаксис labels
- Непонятно где смотреть ошибки
- Документация сложная

**Победитель**: NPM

---

## 🔄 Миграция

### Можно ли переключиться?

**Да!** Оба используют Docker, легко мигрировать.

### NPM → Traefik

1. Экспортируйте настройки из NPM
2. Конвертируйте в labels
3. Добавьте в docker-compose.yml
4. Остановите NPM, запустите Traefik

### Traefik → NPM

1. Посмотрите labels контейнеров
2. Запустите NPM
3. Создайте Proxy Hosts вручную
4. Остановите Traefik

**Время миграции**: 30-60 минут для 5-10 сервисов

---

## 💰 Стоимость

| | NPM | Traefik |
|---|-----|---------|
| **Лицензия** | 🆓 Бесплатно | 🆓 Бесплатно (Open Source) |
| **Поддержка** | Community | Community + Enterprise |
| **Ресурсы** | ~100MB RAM | ~50MB RAM |
| **CPU** | Низкое | Низкое |

Оба бесплатны и легковесны!

---

## 🎯 Рекомендации для slon.prvms.ru

### Если это ваш первый проект:
→ **Начните с NPM** ([NPM_MULTI_SUBDOMAIN.md](NPM_MULTI_SUBDOMAIN.md))

**Плюсы:**
- Быстрый старт
- Понятный GUI
- Меньше кривая обучения

### Если планируете масштабирование:
→ **Используйте Traefik** ([TRAEFIK_QUICKSTART.md](TRAEFIK_QUICKSTART.md))

**Плюсы:**
- Всё в коде (git)
- Легко добавлять сервисы
- Готовность к CI/CD

### Если не уверены:
→ **Попробуйте оба!**

```bash
# День 1: NPM
docker-compose -f docker-compose.npm-simple.yml up -d

# День 2: Traefik (в другой папке)
cd /tmp/test-traefik
docker-compose -f docker-compose.traefik.yml up -d

# Выберите что больше нравится
```

---

## 📖 Документация

### Nginx Proxy Manager
- 📄 [NPM_MULTI_SUBDOMAIN.md](NPM_MULTI_SUBDOMAIN.md) - Детальная инструкция
- 📄 [QUICKSTART_slon.prvms.ru.md](QUICKSTART_slon.prvms.ru.md) - Быстрый старт
- 🔧 Файлы: `docker-compose.npm-simple.yml`, `docker-compose.prod.yml`

### Traefik
- 📄 [TRAEFIK_SETUP.md](TRAEFIK_SETUP.md) - Полная инструкция
- 📄 [TRAEFIK_QUICKSTART.md](TRAEFIK_QUICKSTART.md) - Quick start
- 🔧 Файл: `docker-compose.traefik.yml`

---

## ✅ Итоговая таблица

| Вопрос | Ответ |
|--------|--------|
| Что проще? | NPM |
| Что для профи? | Traefik |
| Что для CI/CD? | Traefik |
| Что для новичков? | NPM |
| Что для микросервисов? | Traefik |
| Что быстрее настроить? | NPM |
| Что лучше для автоматизации? | Traefik |
| Что я должен выбрать для slon.prvms.ru? | **Зависит от опыта!** |

---

## 🎉 Заключение

**Нет правильного выбора - есть подходящий для ВАС выбор.**

- 🟢 **Новичок?** → NPM
- 🟢 **Опытный?** → Traefik
- 🟢 **Не уверены?** → Попробуйте оба!

Оба инструмента отличные и справятся с задачей! 🚀
