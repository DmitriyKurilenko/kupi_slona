"""
Генератор уникальных имен слонов на основе RGB компонентов цвета.

Каждый цвет генерирует имя из трёх частей:
- R (0-255) → Прилагательное (характер, размер, качество)
- G (0-255) → Существительное (природа, предметы, явления)
- B (0-255) → Существительное в родительном падеже (поэтическая добавка)

Формат: "Прилагательное Существительное Существительное(род.п.)"
Примеры: "Вечный Свет Мечты", "Храбрая Заря Судьбы", "Мудрый Рассвет Надежды"
"""


# Прилагательные (для R компонента, 0-255)
# Разделяем на 32 слова (~8 значений на слово)
# Используем формы мужского/женского рода в зависимости от существительного
ADJECTIVES_M = [
    'Крошечный',    # 0-7
    'Быстрый',      # 8-15
    'Нежный',       # 16-23
    'Яркий',        # 24-31
    'Спокойный',    # 32-39
    'Смелый',       # 40-47
    'Мудрый',       # 48-55
    'Счастливый',   # 56-63
    'Храбрый',      # 64-71
    'Благородный',  # 72-79
    'Тихий',        # 80-87
    'Дикий',        # 88-95
    'Древний',      # 96-103
    'Мистический',  # 104-111
    'Королевский',  # 112-119
    'Священный',    # 120-127
    'Золотой',      # 128-135
    'Серебряный',   # 136-143
    'Космический',  # 144-151
    'Мечтательный', # 152-159
    'Могучий',      # 160-167
    'Ласковый',     # 168-175
    'Свирепый',     # 176-183
    'Грациозный',   # 184-191
    'Сияющий',      # 192-199
    'Звёздный',     # 200-207
    'Грозовой',     # 208-215
    'Хрустальный',  # 216-223
    'Алмазный',     # 224-231
    'Огненный',     # 232-239
    'Бурный',       # 240-247
    'Вечный',       # 248-255
]

ADJECTIVES_F = [
    'Крошечная',    # 0-7
    'Быстрая',      # 8-15
    'Нежная',       # 16-23
    'Яркая',        # 24-31
    'Спокойная',    # 32-39
    'Смелая',       # 40-47
    'Мудрая',       # 48-55
    'Счастливая',   # 56-63
    'Храбрая',      # 64-71
    'Благородная',  # 72-79
    'Тихая',        # 80-87
    'Дикая',        # 88-95
    'Древняя',      # 96-103
    'Мистическая',  # 104-111
    'Королевская',  # 112-119
    'Священная',    # 120-127
    'Золотая',      # 128-135
    'Серебряная',   # 136-143
    'Космическая',  # 144-151
    'Мечтательная', # 152-159
    'Могучая',      # 160-167
    'Ласковая',     # 168-175
    'Свирепая',     # 176-183
    'Грациозная',   # 184-191
    'Сияющая',      # 192-199
    'Звёздная',     # 200-207
    'Грозовая',     # 208-215
    'Хрустальная',  # 216-223
    'Алмазная',     # 224-231
    'Огненная',     # 232-239
    'Бурная',       # 240-247
    'Вечная',       # 248-255
]

# Существительные с указанием рода (для G компонента, 0-255)
# Разделяем на 32 слова (~8 значений на слово)
# Формат: (слово, род) где род: 'm' - мужской, 'f' - женский
NOUNS = [
    ('Свет', 'm'),          # 0-7
    ('Луна', 'f'),          # 8-15
    ('Облако', 'n'),        # 16-23
    ('Ручей', 'm'),         # 24-31
    ('Пик', 'm'),           # 32-39
    ('Океан', 'm'),         # 40-47
    ('Лес', 'm'),           # 48-55
    ('Луг', 'm'),           # 56-63
    ('Ветер', 'm'),         # 64-71
    ('Каньон', 'm'),        # 72-79
    ('Ледник', 'm'),        # 80-87
    ('Вихрь', 'm'),         # 88-95
    ('Рассвет', 'm'),       # 96-103
    ('Заря', 'f'),          # 104-111
    ('Затмение', 'n'),      # 112-119
    ('Солнцестояние', 'n'), # 120-127
    ('Горизонт', 'm'),      # 128-135
    ('Сумрак', 'm'),        # 136-143
    ('Восход', 'm'),        # 144-151
    ('Закат', 'm'),         # 152-159
    ('Уголь', 'm'),         # 160-167
    ('Мороз', 'm'),         # 168-175
    ('Гром', 'm'),          # 176-183
    ('Бриз', 'm'),          # 184-191
    ('Шторм', 'm'),         # 192-199
    ('Дождь', 'm'),         # 200-207
    ('Снег', 'm'),          # 208-215
    ('Туман', 'm'),         # 216-223
    ('Дымка', 'f'),         # 224-231
    ('Искра', 'f'),         # 232-239
    ('Пепел', 'm'),         # 240-247
    ('Пыль', 'f'),          # 248-255
]

# Третье слово - существительные в родительном падеже (для B компонента)
# Разделяем на 16 слов (~16 значений на слово)
# Добавляют поэтичности и уникальности имени
GENITIVE_NOUNS = [
    'Мечты',      # 0-15
    'Судьбы',     # 16-31
    'Надежды',    # 32-47
    'Тайны',      # 48-63
    'Славы',      # 64-79
    'Воли',       # 80-95
    'Силы',       # 96-111
    'Души',       # 112-127
    'Чести',      # 128-143
    'Веры',       # 144-159
    'Любви',      # 160-175
    'Правды',     # 176-191
    'Свободы',    # 192-207
    'Радости',    # 208-223
    'Печали',     # 224-239
    'Вечности',   # 240-255
]


def hex_to_rgb(hex_color: str) -> tuple[int, int, int]:
    """
    Конвертирует HEX цвет в RGB компоненты.

    Args:
        hex_color: Цвет в формате '#RRGGBB' или 'RRGGBB'

    Returns:
        Кортеж (R, G, B) где каждый компонент в диапазоне 0-255
    """
    hex_color = hex_color.lstrip('#')
    return tuple(int(hex_color[i:i+2], 16) for i in (0, 2, 4))


def generate_elephant_name(color_hex: str) -> str:
    """
    Генерирует уникальное имя слона на основе его цвета.

    Каждая RGB компонента влияет на часть имени:
    - R (Red) → Прилагательное (характер, размер, качество)
    - G (Green) → Существительное (природный объект, явление)
    - B (Blue) → Существительное в родительном падеже (поэтическая добавка)

    Args:
        color_hex: Цвет в формате '#RRGGBB'

    Returns:
        Уникальное имя слона из трёх слов, например: 'Вечный Свет Мечты', 'Храбрая Заря Судьбы'

    Examples:
        >>> generate_elephant_name('#FF0000')
        'Вечный Свет Мечты'
        >>> generate_elephant_name('#00FF00')
        'Крошечная Пыль Мечты'
        >>> generate_elephant_name('#0000FF')
        'Крошечный Свет Вечности'
    """
    r, g, b = hex_to_rgb(color_hex)

    # Выбираем части имени на основе RGB компонентов
    adjective_index = r // 8    # 256 / 8 = 32 прилагательных
    noun_index = g // 8         # 256 / 8 = 32 существительных
    genitive_index = b // 16    # 256 / 16 = 16 существительных в род. падеже

    # Получаем существительное и его род
    noun, gender = NOUNS[min(noun_index, len(NOUNS) - 1)]

    # Выбираем прилагательное в правильном роде
    if gender == 'f':
        adjective = ADJECTIVES_F[min(adjective_index, len(ADJECTIVES_F) - 1)]
    else:  # 'm' или 'n' (средний род использует мужские формы)
        adjective = ADJECTIVES_M[min(adjective_index, len(ADJECTIVES_M) - 1)]

    # Получаем третье слово (существительное в родительном падеже)
    genitive_noun = GENITIVE_NOUNS[min(genitive_index, len(GENITIVE_NOUNS) - 1)]

    # Собираем трёхсловное имя
    return f"{adjective} {noun} {genitive_noun}"


def get_name_components(color_hex: str) -> dict[str, str]:
    """
    Возвращает компоненты имени отдельно (для отладки или UI).

    Args:
        color_hex: Цвет в формате '#RRGGBB'

    Returns:
        Словарь с ключами 'adjective', 'noun', 'genitive_noun', 'gender', 'full_name'
    """
    r, g, b = hex_to_rgb(color_hex)

    adjective_index = r // 8
    noun_index = g // 8
    genitive_index = b // 16

    # Получаем существительное и его род
    noun, gender = NOUNS[min(noun_index, len(NOUNS) - 1)]

    # Выбираем прилагательное в правильном роде
    if gender == 'f':
        adjective = ADJECTIVES_F[min(adjective_index, len(ADJECTIVES_F) - 1)]
    else:
        adjective = ADJECTIVES_M[min(adjective_index, len(ADJECTIVES_M) - 1)]

    # Получаем третье слово
    genitive_noun = GENITIVE_NOUNS[min(genitive_index, len(GENITIVE_NOUNS) - 1)]

    # Собираем полное имя
    full_name = f"{adjective} {noun} {genitive_noun}"

    return {
        'adjective': adjective,
        'noun': noun,
        'genitive_noun': genitive_noun,
        'gender': gender,
        'full_name': full_name,
    }
